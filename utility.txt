utility functions for verion 2